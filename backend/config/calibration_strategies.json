[
    {
        "id": "linear",
        "name": "Linear Interpolation (Standard)",
        "description": "Standard y = mx + c calibration. Suitable for most analog sensors.",
        "category": "SENSOR",
        "compatibility": [
            "sensor",
            "analog"
        ],
        "storageSchema": {
            "multiplier": {
                "type": "number",
                "required": true,
                "default": 1
            },
            "offset": {
                "type": "number",
                "required": true,
                "default": 0
            }
        },
        "wizard": {
            "component": "LinearWizard",
            "steps": [
                {
                    "type": "input",
                    "key": "multiplier",
                    "label": "Multiplier (Slope)",
                    "default": 1
                },
                {
                    "type": "input",
                    "key": "offset",
                    "label": "Offset (Intercept)",
                    "default": 0
                }
            ]
        }
    },
    {
        "id": "two_point_linear",
        "name": "Two-Point Calibration",
        "description": "Calibrate using two known reference points (e.g., pH 4.0 and 7.0). System calculates slope and offset.",
        "category": "SENSOR",
        "compatibility": [
            "ph",
            "ec",
            "do"
        ],
        "storageSchema": {
            "multiplier": {
                "type": "number",
                "required": true
            },
            "offset": {
                "type": "number",
                "required": true
            }
        },
        "wizard": {
            "component": "TwoPointWizard",
            "steps": [
                {
                    "type": "measure",
                    "label": "Low Reference Point",
                    "refKey": "lowRef",
                    "instructions": "Place sensor in LOW reference solution (e.g., pH 4.0)."
                },
                {
                    "type": "measure",
                    "label": "High Reference Point",
                    "refKey": "highRef",
                    "instructions": "Place sensor in HIGH reference solution (e.g., pH 7.0)."
                }
            ]
        }
    },
    {
        "id": "three_point_linear",
        "name": "Three-Point Calibration",
        "description": "High precision calibration using three reference points (e.g., pH 4, 7, 10).",
        "category": "SENSOR",
        "compatibility": [
            "ph"
        ],
        "storageSchema": {
            "multiplier": {
                "type": "number",
                "required": true
            },
            "offset": {
                "type": "number",
                "required": true
            }
        },
        "wizard": {
            "component": "ThreePointWizard",
            "steps": [
                {
                    "type": "measure",
                    "label": "Low Point (e.g. pH 4)",
                    "refKey": "lowRef",
                    "instructions": "Place sensor in LOW reference solution."
                },
                {
                    "type": "measure",
                    "label": "Mid Point (e.g. pH 7)",
                    "refKey": "midRef",
                    "instructions": "Place sensor in MID reference solution."
                },
                {
                    "type": "measure",
                    "label": "High Point (e.g. pH 10)",
                    "refKey": "highRef",
                    "instructions": "Place sensor in HIGH reference solution."
                }
            ]
        }
    },
    {
        "id": "ph_smart",
        "name": "Smart pH Tracker (Segmented)",
        "description": "Advanced 1, 2 or 3-point segmented linear conversion with temperature compensation.",
        "category": "SENSOR",
        "compatibility": [
            "ph"
        ],
        "storageSchema": {
            "points": {
                "type": "array",
                "required": true,
                "items": {
                    "type": "object",
                    "properties": {
                        "raw": {
                            "type": "number"
                        },
                        "value": {
                            "type": "number"
                        }
                    }
                }
            }
        },
        "wizard": {
            "component": "PhSmartWizard",
            "steps": [
                {
                    "type": "points_table",
                    "label": "pH Calibration Points",
                    "instructions": "Place sensor in buffer solution (e.g. 4.0, 7.0, 10.0). Click 'READ' to capture raw value, then enter buffer pH.",
                    "key": "points",
                    "headers": [
                        {
                            "label": "Raw Reading",
                            "key": "raw",
                            "readOnly": false,
                            "action": "READ"
                        },
                        {
                            "label": "Buffer pH",
                            "key": "value",
                            "readOnly": false
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "ph_dfr",
        "name": "DFRobot pH (Pro/V2) [Legacy]",
        "description": "Traditional pH conversion using Neutral (7.0) and Acid (4.0) voltage offsets.",
        "category": "SENSOR",
        "compatibility": [
            "ph"
        ],
        "storageSchema": {
            "neutralVoltage": {
                "type": "number",
                "required": true,
                "default": 1500
            },
            "acidVoltage": {
                "type": "number",
                "required": true,
                "default": 2032
            }
        },
        "wizard": {
            "component": "PhDfrWizard",
            "steps": [
                {
                    "type": "measure",
                    "label": "Neutral Point (pH 7.0)",
                    "refKey": "neutral",
                    "instructions": "Place sensor in pH 7.0 buffer solution."
                },
                {
                    "type": "measure",
                    "label": "Acid Point (pH 4.0)",
                    "refKey": "acid",
                    "instructions": "Place sensor in pH 4.0 buffer solution."
                }
            ]
        }
    },
    {
        "id": "offset_only",
        "name": "Offset Only (Tare)",
        "description": "Adjusts only the zero-point (intercept). Slope remains 1.",
        "category": "SENSOR",
        "compatibility": [
            "scale",
            "temp"
        ],
        "storageSchema": {
            "offset": {
                "type": "number",
                "required": true
            }
        },
        "wizard": {
            "component": "OffsetWizard",
            "steps": [
                {
                    "type": "measure",
                    "label": "Zero Point (Tare)",
                    "refKey": "zeroRef",
                    "instructions": "Ensure sensor is at zero state (e.g. empty scale)."
                }
            ]
        }
    },
    {
        "id": "volumetric_flow",
        "name": "Volumetric Flow (Dosing)",
        "description": "Calibrate pumps by measuring output volume over a specific time to determine flow rate.",
        "category": "ACTUATOR",
        "capabilities": [
            "DIGITAL_WRITE"
        ],
        "compatibility": [
            "pump",
            "valve",
            "doser"
        ],
        "storageSchema": {
            "flowRate": {
                "type": "number",
                "required": true
            },
            "unit": {
                "type": "string",
                "required": true,
                "enum": [
                    "ml",
                    "l",
                    "g"
                ]
            }
        },
        "wizard": {
            "component": "TimeBasedWizard",
            "steps": [
                {
                    "type": "input",
                    "label": "Calibration Data",
                    "instructions": "Enter the measured volume and test duration. If you don't have this data, use the 'Run Test' option below.",
                    "fields": [
                        {
                            "key": "measuredValue",
                            "label": "Measured Output",
                            "unit": "ml"
                        },
                        {
                            "key": "duration_seconds",
                            "label": "Test Duration",
                            "unit": "sec"
                        }
                    ],
                    "optionalAction": {
                        "label": "Run Test (Optional)",
                        "description": "Run the pump for a set time to generate calibration data.",
                        "command": "TEST_DOSING",
                        "params": {
                            "duration": "input_duration_seconds"
                        },
                        "instructions": "Place output tube in a measuring cup."
                    }
                }
            ],
            "formula": "measuredValue / duration_seconds"
        }
    },
    {
        "id": "range_linear",
        "name": "Range Mapping (Linear)",
        "description": "Map 0-100% UI range to specific hardware limits (e.g., Servo angles or PWM limits).",
        "category": "ACTUATOR",
        "capabilities": [
            "PWM_WRITE"
        ],
        "compatibility": [
            "servo",
            "dimmer",
            "motor"
        ],
        "storageSchema": {
            "minRaw": {
                "type": "number",
                "required": true
            },
            "maxRaw": {
                "type": "number",
                "required": true
            }
        },
        "wizard": {
            "component": "RangeWizard",
            "steps": [
                {
                    "type": "set_limit",
                    "label": "Set Minimum (0%)",
                    "key": "minRaw",
                    "instructions": "Adjust slider to the desired minimum position."
                },
                {
                    "type": "set_limit",
                    "label": "Set Maximum (100%)",
                    "key": "maxRaw",
                    "instructions": "Adjust slider to the desired maximum position."
                }
            ]
        }
    },
    {
        "id": "duration_position",
        "name": "Duration to Position (Motorized Valve)",
        "description": "Controls position (0-100%) based on travel time. Supports separate Open/Close durations.",
        "category": "ACTUATOR",
        "compatibility": [
            "valve_motorized",
            "curtain"
        ],
        "storageSchema": {
            "durationOpen": {
                "type": "number",
                "required": true,
                "description": "Time in ms to travel 0% -> 100%"
            },
            "durationClose": {
                "type": "number",
                "required": true,
                "description": "Time in ms to travel 100% -> 0%"
            }
        },
        "wizard": {
            "component": "DurationWizard",
            "steps": [
                {
                    "type": "input",
                    "label": "Calibration Data",
                    "instructions": "Enter the time it takes to fully open and close the valve. If unknown, use the Test buttons below to measure.",
                    "fields": [
                        {
                            "key": "durationOpen",
                            "label": "Opening Time",
                            "unit": "ms"
                        },
                        {
                            "key": "durationClose",
                            "label": "Closing Time",
                            "unit": "ms"
                        }
                    ],
                    "actions": [
                        {
                            "label": "Test Open (Measure)",
                            "command": "OPEN",
                            "instructions": "Click Start to open. Click Stop when fully open. Duration will be recorded.",
                            "writeToField": "durationOpen"
                        },
                        {
                            "label": "Test Close (Measure)",
                            "command": "CLOSE",
                            "instructions": "Click Start to close. Click Stop when fully closed. Duration will be recorded.",
                            "writeToField": "durationClose"
                        }
                    ]
                }
            ]
        }
    },
    {
        "id": "tank_volume",
        "name": "Tank Volume (Multi-Point)",
        "description": "Convert distance (mm) to volume (L) using a custom lookup table. Ideal for tanks with irregular shapes.",
        "category": "SENSOR",
        "compatibility": [
            "ultrasonic",
            "distance",
            "analog"
        ],
        "storageSchema": {
            "points": {
                "type": "array",
                "required": true,
                "items": {
                    "type": "object",
                    "properties": {
                        "raw": {
                            "type": "number"
                        },
                        "value": {
                            "type": "number"
                        }
                    }
                }
            },
            "unit": {
                "type": "string",
                "default": "L"
            }
        },
        "wizard": {
            "component": "TableWizard",
            "steps": [
                {
                    "type": "points_table",
                    "label": "Calibration Table",
                    "instructions": "Add at least 2 points to define the relationship between Distance and Volume. Use 'Get Reading' to capture the current sensor value.",
                    "key": "points",
                    "headers": [
                        {
                            "label": "Distance (mm)",
                            "key": "raw",
                            "readOnly": false,
                            "action": "READ"
                        },
                        {
                            "label": "Volume (L)",
                            "key": "value",
                            "readOnly": false
                        }
                    ]
                }
            ]
        }
    }
]